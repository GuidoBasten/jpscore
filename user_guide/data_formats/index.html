<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>File formats - JuPedSim/jpscore</title>
      
      
      
        <link rel="canonical" href="http://www.jupedsim.org/user_guide/data_formats/">
      
      
        <meta name="author" content="Mohcine Chraibi">
      
    
    <meta property="og:url" content="http://www.jupedsim.org/user_guide/data_formats/">
    <meta property="og:title" content="JuPedSim/jpscore">
    <meta property="og:image" content="http://www.jupedsim.org/user_guide/data_formats//../../img/sim.png">
    <meta name="apple-mobile-web-app-title" content="JuPedSim/jpscore">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../../img/sim.png">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../../../favicon.icon">
    <link rel="icon" type="image/x-icon" href="../../../../favicon.icon">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-a422ff04cc.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700|Roboto+Mono">
      <style>
        body, input {
          font-family: 'Roboto', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Roboto Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../../html/customdoxygen.css">
    
      <link rel="stylesheet" href="../../html/doxygen.css">
    
      <link rel="stylesheet" href="../../html/tabs.css">
    
    <script src="../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-orange palette-accent-light-blue">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
          </span>
        
        File formats
      </div>
    </div>
    
      
      <div class="button button-twitter" role="button" aria-label="Twitter">
        <a href="https://twitter.com/JuPedSim" title="@JuPedSim on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
      </div>
    
    
      
      <div class="button button-github" role="button" aria-label="GitHub">
        <a href="https://github.com/JuPedSim" title="@JuPedSim on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
      </div>
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/JuPedSim/jpscore" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../../img/sim.png">
        </div>
      
      <div class="name">
        <strong>
          JuPedSim/jpscore
          <span class="version">
            v0.8.1
          </span>
        </strong>
        
          <br>
          JuPedSim/jpscore
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/JuPedSim/jpscore/archive/v0.8.1.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/JuPedSim/jpscore/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="../..">
      Home
    </a>
    
  </li>

          
            
  <li>
    <span class="section">User guide</span>
    <ul>
      
        
  <li>
    <a class="" title="Requirements" href="../requirements/">
      Requirements
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Quickstart" href="../quickstart/">
      Quickstart
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Configuration" href="../configuration/">
      Configuration
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Contributing" href="../contributing/">
      Contributing
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="current" title="File formats" href="./">
      File formats
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Geometry" href="#geometry">
                Geometry
              </a>
            </li>
          
            <li class="anchor">
              <a title="Inifile" href="#inifile">
                Inifile
              </a>
            </li>
          
            <li class="anchor">
              <a title="Trajectory" href="#trajectory">
                Trajectory
              </a>
            </li>
          
        </ul>
      
    
  </li>

          
            
  <li>
    <span class="section">Models</span>
    <ul>
      
        
  <li>
    <a class="" title="Operational models" href="../../models/operativ/">
      Operational models
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Direction strategies" href="../../models/direction/">
      Direction strategies
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Routing" href="../../models/routing/">
      Routing
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Tests</span>
    <ul>
      
        
  <li>
    <a class="" title="Introduction" href="../../tests/introduction/">
      Introduction
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="RiMEA" href="../../tests/rimea/">
      RiMEA
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Juelich" href="../../tests/juelich/">
      Juelich
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">About</span>
    <ul>
      
        
  <li>
    <a class="" title="Disclaimer" href="../../about/disclaimer/">
      Disclaimer
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="License" href="../../about/LICENSE/">
      License
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Contributors" href="../../about/contributors/">
      Contributors
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="" title="Publications" href="../../publications/">
      Publications
    </a>
    
  </li>

          
            
  <li>
    <a class="" title="API" href="../../doxygen/">
      API
    </a>
    
  </li>

          
        </ul>
        
          <hr>
          <span class="section">The author</span>
          <ul>
            
              
              <li>
                <a href="https://twitter.com/JuPedSim" target="_blank" title="@JuPedSim on Twitter">
                  @JuPedSim on Twitter
                </a>
              </li>
            
            
              
              <li>
                <a href="https://github.com/JuPedSim" target="_blank" title="@JuPedSim on GitHub">
                  @JuPedSim on GitHub
                </a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <h1 id="file-formats"><a class="toclink" href="#file-formats">File formats</a></h1>
<p><code>jpscore</code> uses two input files and produces an output file with trajectories.</p>
<p><img alt="jpscore_input" src="../img/jpscore_inout.png" /></p>
<p>The <a href="#geometry">geometry file</a> defines the scenario that should be used in the simulation, 
while the <a href="#inifile">inifile</a> defines different settings, parameter values, population properties etc. </p>
<p>The result of a (successful) simulation is saved in a <a href="#trajectory">trajectory file</a> in a given format.</p>
<h2 id="geometry"><a class="toclink" href="#geometry">Geometry</a></h2>
<p>The main structure of the geometry file is as follows </p>
<p><img alt="jpsgeometry" src="../img/geometry_classes.png" /></p>
<hr />
<p>Following picture shows a sample geometry with one room, two subrooms and one obstacle.</p>
<p><img alt="corner" src="../img/Subrooms.png" /></p>
<p><code>subrooms</code> and <code>rooms</code> are two different concepts to organize a geometry. 
Basically, it is up to the user to organize its geometry &ldquo;roomwise&rdquo; or &ldquo;subroomwise&rdquo;.</p>
<p>For instance the above mentioned geometry could also be organized using two rooms as follows:
<img alt="rooms" src="../img/Rooms.png" /></p>
<hr />
<p>A geometry can be produces manually (for small scenarios) or with <a href="https://cst.version.fz-juelich.de/jupedsim/jpseditor">jpseditor</a>.
In both cases it is recommended to visualize the geometry once finishedwith <a href="https://cst.version.fz-juelich.de/jupedsim/jpsvis">jpsvis</a>.</p>
<p>The main components of a geometry are: </p>
<ul>
<li><a href="#rooms">Rooms</a></li>
<li><a href="#subrooms">Subrooms</a></li>
<li><a href="#obstacles">Obstacles</a></li>
<li><a href="#transitions">Transitions</a></li>
<li><a href="#crossings">Crossings</a></li>
</ul>
<h3 id="rooms"><a class="toclink" href="#rooms">Rooms</a></h3>
<p>The geometry contains at least one room and one transition. 
Each room has a unique <code>id</code>, an optional caption and at least one <code>subroom</code>. 
Two rooms are separated by either walls or transitions.</p>
<pre><code class="xml">&lt;rooms&gt;
    &lt;room id=&quot;0&quot; caption=&quot;hall&quot; &gt;
&lt;/rooms&gt;
</code></pre>

<h3 id="subrooms"><a class="toclink" href="#subrooms">Subrooms</a></h3>
<p>Subrooms define the navigation mesh, i.e the walkable areas in the geometry. 
Each <code>subroom</code> is bounded by at least one <code>crossing</code>. 
Here a sample:</p>
<pre><code class="xml">&lt;subroom id=&quot;1&quot; class=&quot;stair&quot; A_x=&quot;−1.2&quot; B_y=&quot;0&quot; C=&quot;0&quot;&gt; 
    &lt;polygon caption=&quot;wall&quot;&gt;
        &lt;vertex px=&quot;0.0&quot; py=&quot;1.0&quot;/&gt;
        &lt;vertex px=&quot;−5.0&quot; py=&quot;1.0&quot;/&gt; 
    &lt;/ polygon&gt;
    &lt;polygon caption=&quot;wall&quot;&gt;
        &lt;vertex px=&quot;0.0&quot; py=&quot;3.0&quot;/&gt; 
        &lt;vertex px=&quot;−5.0&quot; py=&quot;3.0&quot;/&gt;
        &lt;/ polygon&gt;
    &lt;up px=&quot;−5.0&quot; py=&quot;2&quot;/&gt; 
    &lt;down px=&quot;0.0&quot; py=&quot;2&quot;/&gt;
&lt;/subroom&gt;
</code></pre>

<ul>
<li><code>id</code> mandatory parameter, also referred by crossings and transitions.     </li>
<li><code>class</code> optional parameter defining the type of the subroom. At the moment two classes are defined:</li>
<li><code>floor</code></li>
<li><code>stairs</code> take additionally
    <code>&lt;up px="-5.0" py="2" /&gt;</code> and   <code>&lt;down px="0.0" py="2" /&gt;</code>, which are 
    used for visualisation purposes.</li>
<li>
<p>
<script type="math/tex">A\_x,\; B\_y,\rm{and}\; C</script> are optional parameter for the explicit plane equation of the subroom,
   for the construction of a 3D environment and should be used to describe stairs. <br />
   The plane equation is given by:  <script type="math/tex">Z = Ax +By + C</script>. 
   For instance, if the stair goes through the following points: <script type="math/tex">P_1(1,0,0),\; P_2 (0,1,0)\; \rm{and}\; P_3(0,0,1)</script> 
   then the equation is given by: <script type="math/tex">Z= -x -y +1</script>.</p>
</li>
<li>
<p><code>polygon</code> describes the walls as a sequence of vertexes.</p>
</li>
</ul>
<p>To ease navigation, it is recommended to always use convex subrooms. 
In the case the subroom is not convex, additional navigation lines might be required
or the floor field router should be used. </p>
<hr />
<p><strong>Note</strong>: Every <code>room</code> has at least one <code>subroom</code>.</p>
<hr />
<h3 id="obstacles"><a class="toclink" href="#obstacles">Obstacles</a></h3>
<p>One or more obstacles can also be defined within a <code>subroom</code>. </p>
<hr />
<p><strong>Note</strong>: Obstacles should not intersect with other geometry elements e.g. walls, crossings or transitions.</p>
<hr />
<p>Sample obstacle in a subroom</p>
<pre><code class="xml">&lt;obstacle id=&quot;0&quot; caption=&quot;table&quot; height=&quot;1.0&quot; &gt;
    &lt;polygon&gt;
        &lt;vertex px=&quot;12.0&quot; py=&quot;6.0&quot;/&gt;
        &lt;vertex px=&quot;13.0&quot; py=&quot;6.0&quot;/&gt;
        &lt;vertex px=&quot;13.0&quot; py=&quot;5.5&quot;/&gt;
        &lt;vertex px=&quot;12.0&quot; py=&quot;5.5&quot;/&gt;
        &lt;vertex px=&quot;12.0&quot; py=&quot;6.0&quot;/&gt;
    &lt;/polygon&gt;
&lt;/obstacle&gt;
</code></pre>

<ul>
<li><code>id</code>, mandatory unique identifier for this obstacle.</li>
<li><code>caption</code>, used in the visualisation.</li>
<li><code>height</code>, optional parameter, not used at the moment</li>
<li><code>polygon</code>, describing the obstacle as a sequence of vertex.</li>
</ul>
<h3 id="transitions"><a class="toclink" href="#transitions">Transitions</a></h3>
<p>A <code>transition</code> defines the connection between two rooms and is basically a door.
It can be close or open (see <a href="#traffic-constraints">&ldquo;traffic constraints&rdquo;</a>).</p>
<p>An example transition between two rooms </p>
<pre><code class="xml">&lt;!-- exits between rooms or to outside (room with index = -1) --&gt;
&lt;transition id=&quot;1&quot; caption=&quot;main exit&quot; type=&quot;emergency&quot;
room1_id=&quot;0&quot; subroom1_id=&quot;1&quot; room2_id=&quot;-1&quot; subroom2_id=&quot;-1&quot;&gt;
    &lt;vertex px=&quot;15.0&quot; py=&quot;-5.0&quot;/&gt;
    &lt;vertex px=&quot;17.0&quot; py=&quot;-5.0&quot;/&gt;
&lt;/transition&gt;
</code></pre>

<ul>
<li><code>id</code>, mandatory unique identifier.
  The <code>id</code> is also used to close or open the door in the <a href="#traffic-constraints">&ldquo;traffic constraints&rdquo;</a> section of the inifile.</li>
<li><code>caption</code>, optional, used in the visualisation.</li>
<li><code>type</code>, optional. </li>
<li><code>room1_id</code>, the first room sharing this transition. The order is not important.</li>
<li><code>subroom1_id</code>, the first <code>subroom</code> located in <code>room_1</code>.</li>
<li><code>room2_id</code>, the second room sharing this transition. 
  The order is not important. 
  If there is no second room (meaning this transition is connected to the outside), then use <code>-1</code>.</li>
<li><code>subroom2_id</code>, the second <code>subroom</code> sharing this transition. The order is not important. 
  If there is no second <code>subroom</code> (meaning this transition is connected to the outside), then use <code>-1</code>.</li>
<li><code>vertex</code>: define two ending points of the <code>transition</code>.  </li>
</ul>
<h3 id="crossings"><a class="toclink" href="#crossings">Crossings</a></h3>
<p>A <code>crossing</code> defines the connection between two subrooms inside the same room. 
Unlike <code>transition</code>, they are always open.</p>
<p>A sample <code>crossing</code> between two subrooms</p>
<pre><code class="xml">&lt;!-- virtual exits between subrooms --&gt;
&lt;crossing id=&quot;0&quot; subroom1_id=&quot;0&quot; subroom2_id=&quot;1&quot;&gt;
    &lt;vertex px=&quot;10.0&quot; py=&quot;6.0&quot;/&gt;
    &lt;vertex px=&quot;10.0&quot; py=&quot;4.0&quot;/&gt;
&lt;/crossing&gt;
</code></pre>

<ul>
<li><code>id</code>, mandatory unique identifier for this <code>crossing</code>. </li>
<li><code>subroom1_id</code>, the first <code>subroom</code></li>
<li><code>subroom2_id</code>,  the second <code>subroom</code> sharing this transition. The order is not important. 
  If there is no second subroom (meaning this transition is connected to the outside), 
  then use <code>-1</code>.</li>
<li><code>vertex</code>: define two ending points of the <code>crossing</code>.</li>
</ul>
<h2 id="inifile"><a class="toclink" href="#inifile">Inifile</a></h2>
<p>With the content of the <code>inifile</code>, the simulation with <code>jpscore</code> can be controlled. </p>
<p>The typical structure of an <code>inifile</code> is as follows:</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;JuPedSim project=&quot;JPS-Project&quot; version=&quot;0.8&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
          xsi:noNamespaceSchemaLocation=&quot;https://github.com/JuPedSim/jpscore/blob/master/xsd/jps_ini_core.xsd&quot;&gt;

    &lt;header&gt; 
         &lt;!-- seed , geometry, output format --&gt;
    &lt;/header&gt;        

    &lt;traffic_constraints&gt; 
        &lt;!-- traffic information: e.g closed doors or smoked rooms --&gt;
    &lt;/traffic_constraints&gt;


    &lt;goals&gt;
    &lt;!-- goals (closed polygons) outside the geometry--&gt;
    &lt;goals/&gt;


    &lt;agents&gt;
        &lt;agents_distribution&gt;
            &lt;!--persons information and distribution --&gt; 
        &lt;/agents_distribution&gt;
    &lt;/agents&gt;


    &lt;operational_models&gt;
        &lt;model id=&quot;n&quot; description=&quot;name&quot;&gt;
            &lt;!-- parameters of model (&lt;n&gt;, &quot;name&quot;)  --&gt;
        &lt;/model&gt;
        &lt;!-- other models can be defined --&gt;
    &lt;/operational_models&gt;

    &lt;route_choice_models&gt;
        &lt;router router_id=&quot;n&quot; description=&quot;name&quot;&gt;
            &lt;!-- parameters of router (&lt;n&gt;, &quot;name&quot;)  --&gt;
        &lt;/router&gt;
        &lt;!-- other routers can be defined --&gt;
    &lt;/route_choice_models&gt;

&lt;/JuPedSim&gt;
</code></pre>

<hr />
<p>The main components of the inifile are: </p>
<ul>
<li><a href="#header">header</a></li>
<li><a href="#traffic-constraints">traffic constraints</a></li>
<li><a href="#goals">goals</a></li>
<li><a href="#agents">agents</a></li>
<li><a href="../../../models/operativ/">operational models</a>.</li>
<li><a href="../../../models/routing">route choice models</a>.</li>
</ul>
<hr />
<h3 id="header"><a class="toclink" href="#header">Header</a></h3>
<p>The header comprises the following elements:</p>
<ul>
<li>
<p><code>&lt;seed&gt;s&lt;/seed&gt;</code> </p>
<p>Set the  <code>seed</code> value of the random number generator to <code>s</code>. If missing the
current time (<code>time(NULL)</code>), is used i.e. random initial conditions.</p>
</li>
<li>
<p><code>&lt;max_sim_time&gt;t&lt;/max_sim_time&gt;</code>
    the maximal simulation time in seconds. </p>
</li>
<li>
<p><code>&lt;num_threads&gt;n&lt;/num_threads&gt;</code> the number of used cores.</p>
</li>
<li>
<p><code>&lt;show_statistics&gt;true&lt;/show_statistics</code> Show different aggregate statistics e.g. the usage of the doors. (default: false) </p>
</li>
<li>
<p><code>&lt;logfile&gt;log.txt&lt;/logfile&gt;</code> save relevant information about the simulation to a log file. 
  Useful to keep track of warnings or errors that may rise during a simulation.</p>
</li>
<li>
<p>The trajectory file 
   <code>&lt;trajectories format="xml-plain" fps="8" color_mode="velocity"&gt;  &lt;file location="trajectories.xml" /&gt;  &lt;/trajectories&gt;</code></p>
<p>The options for the format are</p>
<ul>
<li>
<p><code>xml-plain</code>: the default xml format. It can lead to large files. See section <a href="#xml-plain">xml-plain</a>.</p>
</li>
<li>
<p><code>plain</code>: simple text format. See section <a href="#plain-text">plain-text</a>.</p>
</li>
<li>
<p>The value <code>fps</code> defines the frame rate per second for the trajectories. </p>
</li>
<li>
<p><code>color_mode</code>: coloring agents in the trajectories. Options are:   </p>
</li>
<li><code>velocity</code> (default): color is proportional to speed (slow &ndash;&gt; red). </li>
<li><code>spotlight</code></li>
<li><code>group</code>: color by group</li>
<li><code>knowledge</code> </li>
<li><code>router</code></li>
<li><code>final_goal</code></li>
<li>
<p><code>intermediate_goal</code></p>
</li>
<li>
<p><code>file location</code> defines the location of the trajectories. 
   All paths are relative to
   the location of the project file.</p>
</li>
</ul>
</li>
<li>
<p><code>&lt;geometry&gt;geometry.xml&lt;/geometry&gt;</code>
    The name and location of the geometry file. All file locations are relative
    to the actual location of the project file. See <a href="#geometry">specification</a> of the geometry format.</p>
</li>
</ul>
<h3 id="traffic-constraints"><a class="toclink" href="#traffic-constraints">Traffic constraints</a></h3>
<p>This section defines constraints related to the traffic. 
At the moment the state of the doors can be changed (<code>open</code> or <code>close</code>)</p>
<pre><code class="xml">&lt;traffic_constraints&gt; 
    &lt;!-- doors states are: close or open --&gt;
    &lt;doors&gt;
        &lt;door trans_id=&quot;4&quot; caption=&quot;Main-gate&quot; state=&quot;open&quot; /&gt;
        &lt;door trans_id=&quot;6&quot; caption=&quot;Rear-gate&quot; state=&quot;close&quot; /&gt;
    &lt;/doors&gt;
&lt;/traffic_constraints&gt;
</code></pre>

<ul>
<li>
<p><code>trans_id</code>: unique id of that specific door as defined in the geometry file. See <a href="#geometry">geometry</a>.</p>
</li>
<li>
<p><code>caption</code>: optional parameter defining the caption of the door.</p>
</li>
<li>
<p><code>state</code> defines the state of the door. Options are <code>close</code> or <code>open</code>.</p>
</li>
</ul>
<h3 id="goals"><a class="toclink" href="#goals">Goals</a></h3>
<p>Additional goals might be defined <strong>outside</strong> the geometry. 
They should <em>NOT</em> overlap with any walls or be inside rooms. 
It is recommended to position them near the exits. </p>
<p>Goals are defined with close polygons, with  <em>the last vertex is equal to the first one</em>.</p>
<pre><code class="xml">&lt;routing&gt;
    &lt;goals&gt;
        &lt;goal id=&quot;0&quot; final=&quot;false&quot; caption=&quot;goal 1&quot;&gt;
            &lt;polygon&gt;
                &lt;vertex px=&quot;-5.0&quot; py=&quot;-5.0&quot; /&gt;
                &lt;vertex px=&quot;-5.0&quot; py=&quot;-2.0&quot; /&gt;
                &lt;vertex px=&quot;-3.0&quot; py=&quot;-2.0&quot; /&gt;
                &lt;vertex px=&quot;-3.0&quot; py=&quot;-5.0&quot; /&gt;
                &lt;vertex px=&quot;-5.0&quot; py=&quot;-5.0&quot; /&gt;
                &lt;/polygon&gt;
        &lt;/goal&gt;
        &lt;goal id=&quot;1&quot; final=&quot;false&quot; caption=&quot;goal 2&quot;&gt;
            &lt;polygon&gt;
                &lt;vertex px=&quot;15.0&quot; py=&quot;-5.0&quot; /&gt;
                &lt;vertex px=&quot;17.0&quot; py=&quot;-5.0&quot; /&gt;
                &lt;vertex px=&quot;17.0&quot; py=&quot;-7.0&quot; /&gt;
                &lt;vertex px=&quot;15.0&quot; py=&quot;-7.0&quot; /&gt;
                &lt;vertex px=&quot;15.0&quot; py=&quot;-5.0&quot; /&gt;
            &lt;/polygon&gt;
        &lt;/goal&gt;
    &lt;/goals&gt;
&lt;/routing&gt;
</code></pre>

<h3 id="agents"><a class="toclink" href="#agents">Agents</a></h3>
<p>There are two ways to distribute agents for  a simulation:</p>
<ul>
<li><a href="#agents_distribution">random distribution</a> in a specific area <em>before</em> the simulation starts. </li>
<li>distribution by means of <a href="#sources">sources</a> <em>during</em> the simulation.</li>
</ul>
<h4 id="agents_distribution"><a class="toclink" href="#agents_distribution">Agents_distribution</a></h4>
<p>An example how to define agent&rsquo;s characteristics with different number of
attributes is as follows</p>
<pre><code class="xml">    &lt;agents&gt;
        &lt;agents_distribution&gt;
            &lt;group group_id=&quot;1&quot; room_id=&quot;0&quot; number=&quot;10&quot; /&gt;

            &lt;group group_id=&quot;2&quot; room_id=&quot;0&quot; subroom_id=&quot;0&quot; number=&quot;10&quot; 
                goal_id=&quot;&quot; router_id=&quot;1&quot; /&gt;

            &lt;group group_id=&quot;3&quot; room_id=&quot;0&quot; subroom_id=&quot;1&quot; number=&quot;20&quot; 
                goal_id=&quot;1&quot; router_id=&quot;2&quot; patience=&quot;5&quot;/&gt;

            &lt;group group_id=&quot;4&quot; room_id=&quot;0&quot; number=&quot;200&quot; goal_id=&quot;-1&quot; 
                router_id=&quot;2&quot; patience=&quot;50&quot;/&gt;

            &lt;group group_id=&quot;5&quot; room_id=&quot;0&quot; number=&quot;1&quot; startX=&quot;25.3&quot; startY=&quot;365.90&quot;/&gt;

    &lt;/agents_distribution&gt;
&lt;/agents&gt;
</code></pre>

<ul>
<li>
<p><code>group_id</code>: mandatory parameter defining the unique id of that group.</p>
</li>
<li>
<p><code>number</code>: mandatory parameter defining the number of agents to distribute.</p>
</li>
<li>
<p><code>room_id</code>: mandatory parameter defining the room where the agents should be
randomly distributed.</p>
</li>
<li>
<p><code>subroom_id</code>: defines the id of the subroom where the agents should be distributed. 
  If omitted then the agents are homogeneously distributed in the room. </p>
</li>
<li>
<p><code>goal_id</code>: should be one of the <code>id</code>s defined in the section  <a href="#goals">goals</a>. 
   If omitted or is <code>-1</code> then the shortest exit to the outside is chosen by the agent.</p>
</li>
<li>
<p><code>router_id</code>: defines the route choice model to be used. See <a href="../../../models/router">documentation</a> of available routers.</p>
</li>
<li>
<p><code>age</code>: not yet used by the <a href="../../../model/operativ">operational</a> models.</p>
</li>
<li>
<p><code>gender</code>: not yet used.</p>
</li>
<li>
<p><code>height</code>: not yet used.</p>
</li>
<li>
<p><code>patience</code>:  this parameter influences the route choice behavior when using the quickest path router. 
  It basically defines how long a pedestrian stays in jams before attempting a rerouting.</p>
</li>
<li>
<p><code>premovement_mean</code> and <code>premovement_sigma</code>: premovement time is Gauss-distributed <script type="math/tex">\mathcal{N}(\mu, \sigma^2)</script>.</p>
</li>
<li>
<p>Risk tolerance can be Gauss-distributed, or beta-distributed. 
  If not specified then it is defined as <script type="math/tex">\mathcal{N}(1, 0)</script>:</p>
</li>
<li>
<p><code>risk_tolerance_mean</code> and <code>risk_tolerance_sigma</code>: <script type="math/tex">\mathcal{N}(\mu, \sigma^2)</script>.</p>
</li>
<li>
<p><code>risk_tolerance_alpha</code> and <code>risk_tolerance_beta</code>: <script type="math/tex">Beta(\alpha, \beta)</script>.</p>
</li>
<li>
<p><code>x_min</code>, <code>x_max</code>, <code>y_min</code> and <code>y_max</code>: define a bounding box where agents should be distributed.</p>
</li>
<li>
<p><code>startX</code>, <code>startY</code>: define the initial coordinate of the agents. This might be useful for testing/debugging. 
Note that these two options are only considered if <code>number=1</code>.</p>
</li>
<li>
<p><code>agent_parameter_id</code>: choose a set of parameters for the <a href="../../../models/operativ/">operational models</a>.</p>
</li>
</ul>
<h4 id="sources"><a class="toclink" href="#sources">Sources</a></h4>
<p>Besides distributing agents randomly before the simulation starts, it is
possible to define sources in order to &ldquo;inject&rdquo; 
new agents in the system during the simulation.</p>
<pre><code class="xml">&lt;agents_sources&gt;
&lt;source id=&quot;1&quot; frequency=&quot;2&quot;, agents_max=&quot;10&quot; group_id=&quot;1&quot;, caption=&quot;caption&quot; greedy=&quot;true&quot;/&gt;
&lt;/agents_sources&gt;
</code></pre>

<ul>
<li><code>id</code>: id of the source</li>
<li><code>frequency</code>: number of pedestrians per second.</li>
<li><code>agents_max</code>: maximal number of agents produced by that source.</li>
<li><code>group_id</code>: group id of the agents. This <code>id</code> should match a predefined group in the section <a href="#agents_distribution">Agents_distribution</a>.</li>
<li><code>caption</code>: caption</li>
<li><code>greedy</code> (default <code>false</code>): returns a Voronoi vertex randomly with respect to weights proportional to squared distances.<br />
   For vertexes <script type="math/tex">v_i</script> and distances <script type="math/tex">d_i</script> to their surrounding seeds
   calculate the probabilities <script type="math/tex">p_i</script> as<br />
<script type="math/tex; mode=display">p_i= \frac{d_i^2}{\sum_j^n d_j^2}.</script>
   If this attribute is set to <code>true</code>, the greedy approach is used. 
   That means new agents will be placed on the vertex with the biggest distance to the surrounding seeds.</li>
</ul>
<h2 id="trajectory"><a class="toclink" href="#trajectory">Trajectory</a></h2>
<p>The results of the simulation are written to files or streamed to a network socket.</p>
<p>Possible formats are:</p>
<ul>
<li><code>xml-plain</code> which is the default xml format</li>
<li><code>plain</code> a flat format (just numbers)</li>
</ul>
<p>Note that if you are using the streaming mode or want to visualize the trajectories with <code>jpsvis</code>, 
the format should be <code>xml-plain</code>.</p>
<h3 id="xml-plain"><a class="toclink" href="#xml-plain">xml-plain</a></h3>
<p>The file has three main sections: <code>header</code>, <code>geometry</code> and <code>frames</code>.</p>
<pre><code class="xml">&lt;header version = &quot;0.8&quot;&gt;
    &lt;agents&gt;1&lt;/agents&gt;
    &lt;frameRate&gt;8&lt;/frameRate&gt;
&lt;/header&gt;
</code></pre>

<p>where</p>
<ul>
<li><code>agents</code>: The total number of agents at the beginning of the simulation.</li>
<li>frameRate`: Divide the total number of frames by the framerate to obtain the overall evacuation time.</li>
</ul>
<p>The geometry can be completely embedded within the trajectories or a reference to a file can be supplied.</p>
<pre><code class="xml">&lt;geometry&gt;
    &lt;file location=&quot;corridor_geometry.xml&quot;/&gt;
&lt;/geometry&gt;

</code></pre>

<p>The coordinates of the trajectory are defined in the session <code>frames</code></p>
<pre><code class="xml">&lt;frame ID=&quot;0&quot;&gt;
    &lt;agent ID=&quot;1&quot;   x=&quot;660.00&quot;  y=&quot;333.00&quot;  z=&quot;30.00&quot;   
    rA=&quot;17.94&quot;  rB=&quot;24.94&quot;  eO=&quot;-168.61&quot; eC=&quot;0&quot;/&gt;
&lt;/frame&gt;
&lt;frame ID=&quot;1&quot;&gt;
&lt;agent ID=&quot;1&quot;   x=&quot;658.20&quot;  y=&quot;332.86&quot;  z=&quot;30.00&quot;   
rA=&quot;31.29&quot;  rB=&quot;23.87&quot;  eO=&quot;-175.41&quot; eC=&quot;54&quot;/&gt;
&lt;/frame&gt;
</code></pre>

<ul>
<li><code>ID</code> the id of the pedestrians starting with 1.</li>
<li>
<p><code>x, y, z</code> the position of the agent.</p>
</li>
<li>
<p><code>rA, rB</code>  The shape which is defined by a circle (ellipse) drawn around a human-like figure.<br />
<code>radiusA</code> and <code>radiusB</code> are respectively the semi major axis and the semi minor axis of the ellipse, 
  if the modeled pedestrians&rsquo; shape is an ellipse. 
  Otherwise, if it is a circle those values should be equal to the radius of the circle.</p>
</li>
<li><code>eO, eC</code> are the &ldquo;ellipseOrientation&rdquo; and the &ldquo;ellipseColor&rdquo;. 
  &ldquo;ellipseOrientation&rdquo; is the angle between the  major axis and the X-axis (zero for circle). 
   A color can also be provided, for example for displaying change in velocity. 
   The colours are in the range <code>[0=red, 255=green]</code> and define the proportion between 
   the desired speed (<script type="math/tex">v_0</script>) and the instantaneous velocity.</li>
</ul>
<p>A sample trajectory in the xml format is</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;trajectories&gt;
    &lt;header version = &quot;0.5&quot;&gt;
        &lt;agents&gt;1&lt;/agents&gt;
        &lt;frameRate&gt;8&lt;/frameRate&gt;
    &lt;/header&gt;

    &lt;geometry&gt;
        &lt;file location=&quot;corridor_geometry.xml&quot;/&gt;
    &lt;/geometry&gt;

    &lt;frame ID=&quot;0&quot;&gt;
        &lt;agent ID=&quot;1&quot;   x=&quot;660.00&quot;  y=&quot;333.00&quot;  z=&quot;30.00&quot;   
        rA=&quot;17.94&quot;  rB=&quot;24.94&quot;  eO=&quot;-168.61&quot;    eC=&quot;0&quot;/&gt;
    &lt;/frame&gt;

    &lt;frame ID=&quot;1&quot;&gt;
        &lt;agent ID=&quot;1&quot;   x=&quot;658.20&quot;  y=&quot;332.86&quot;  z=&quot;30.00&quot;   
    rA=&quot;31.29&quot;  rB=&quot;23.87&quot;  eO=&quot;-175.41&quot;    eC=&quot;54&quot;/&gt;
    &lt;/frame&gt;
&lt;/trajectories&gt;
</code></pre>

<h3 id="plain-text"><a class="toclink" href="#plain-text">plain-text</a></h3>
<p>The other format of the trajectory file is <code>plain-text</code></p>
<p>A sample trajectory in the plain format is as follows:</p>
<pre><code class="xml">                #description: simulation
                #framerate: 16
                #geometry: /home/sim/corridor.xml
                #ID: the agent ID
                #FR: the current frame
                #X,Y,Z: the agents coordinates in metres

                #ID FR  X       Y       Z
                1   0   28.21   131.57  0.00
                2   0   38.41   133.42  0.00
                1   1   28.21   131.57  0.00
                2   1   38.41   133.42  0.00
                1   2   28.24   131.57  0.00
                2   2   38.44   133.42  0.00
                1   3   28.29   131.57  0.00
                2   3   38.49   133.42  0.00
                1   4   28.36   131.57  0.00
                2   4   38.56   133.42  0.00
                1   5   28.44   131.57  0.00
                2   5   38.64   133.42  0.00
                1   6   28.54   131.57  0.00
                2   6   38.74   133.42  0.00
                1   7   28.65   131.57  0.00
                2   7   38.85   133.42  0.00
                1   8   28.77   131.57  0.00
</code></pre>
          <aside class="copyright" role="note">
            
              Copyright &copy; 2016 <a href="http://www.fz-juelich.de">Forschungszentrum Jülich GmbH</a>. Maintenance by <a href="http://www.fz-juelich.de/SharedDocs/Personen/IAS/JSC/EN/staff/chraibi_m.html/">Mohcine Chraibi</a>. &ndash;
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../contributing/" title="Contributing">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Contributing
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../../models/operativ/" title="Operational models">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Operational models
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = 'JuPedSim/jpscore';
    </script>
    <script src="../../assets/javascripts/application-997097ee0c.js"></script>
    
      <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
  </body>
</html>