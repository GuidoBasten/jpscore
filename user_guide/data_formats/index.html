<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Mohcine Chraibi">
        <link rel="canonical" href="http://www.jupedsim.org/user_guide/data_formats/">
        <link rel="shortcut icon" href="../../favicon.icon">
        

	<title>File formats - JuPedSim/jpscore</title>

        <link href="../../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../html/customdoxygen.css" rel="stylesheet">
        <link href="../../html/doxygen.css" rel="stylesheet">
        <link href="../../html/tabs.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">JuPedSim/jpscore</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../requirements/">Requirements</a>
                        </li>
                    
                        <li >
                            <a href="../configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="../vagrant/">Vagrant</a>
                        </li>
                    
                        <li >
                            <a href="../quickstart/">Quickstart</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">File formats</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../contributing/">Contributing</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Models <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../models/operativ/">Operational models</a>
                        </li>
                    
                        <li >
                            <a href="../../models/direction/">Direction strategies</a>
                        </li>
                    
                        <li >
                            <a href="../../models/routing/">Routing</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tests <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../tests/introduction/">Introduction</a>
                        </li>
                    
                        <li >
                            <a href="../../tests/rimea/">RiMEA</a>
                        </li>
                    
                        <li >
                            <a href="../../tests/juelich/">Juelich</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../about/disclaimer/">Disclaimer</a>
                        </li>
                    
                        <li >
                            <a href="../../about/LICENSE/">License</a>
                        </li>
                    
                        <li >
                            <a href="../../about/contributors/">Contributors</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../../publications/">Publications</a>
                </li>
            
            
            
                <li >
                    <a href="../../doxygen/">API</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../quickstart/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../../contributing/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/JuPedSim/jpscore">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#file-formats">File formats</a></li>
        
            <li><a href="#geometry">Geometry</a></li>
        
            <li><a href="#inifile">Inifile</a></li>
        
            <li><a href="#trajectory">Trajectory</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="file-formats"><a class="toclink" href="#file-formats">File formats</a></h1>
<p>JuPedSim uses three two input files and produces an output file with trajectories</p>
<p><img alt="jpscore_input" src="../img/jpscore_inout.png" /></p>
<ol>
<li>Inifile: This is the project file that controls the simulation parameter, the population properties, etc. </li>
<li>Geometry file: Defines the geometry that should be used in the simulation</li>
<li>Output of the simulation is a trajectory file.</li>
</ol>
<h2 id="geometry"><a class="toclink" href="#geometry">Geometry</a></h2>
<p>The main structure of the geometry file is as follows 
<img alt="jpsgeometry" src="../img/geometry_classes.png" /></p>
<p>Sample geometry with one room, two subrooms and one obstacle.
An obstacle should not overlap with any wall of the geometry.
<img alt="corner" src="../img/corner_geo.png" /></p>
<p>The main components of a geometry an: 
- Rooms
- Subrooms
- Obstacles
- Crossings
- Transitions</p>
<h3 id="rooms"><a class="toclink" href="#rooms">Rooms</a></h3>
<p>The geometry contains at least one room and one transition. 
Each room has a unique <code>id</code> and optional caption. 
Two rooms are separated by either walls or transitions.</p>
<pre><code class="xml">&lt;rooms&gt;
    &lt;room id=&quot;0&quot; caption=&quot;hall&quot; &gt;
&lt;/rooms&gt;
</code></pre>

<h3 id="subrooms"><a class="toclink" href="#subrooms">Subrooms</a></h3>
<p>Subrooms define the navigation mesh, i.e the walkable areas in the geometry. 
Each <code>subroom</code> is bounded by at least 1 <code>crossing</code>. 
A sample is described in the following listing: </p>
<pre><code class="xml">&lt;subroom id=&quot;1&quot; class=&quot;stair&quot; A x=&quot;−1.2&quot; B y=&quot;0&quot; C=&quot;0&quot;&gt; 
    &lt;polygon caption=&quot;wall&quot;&gt;
        &lt;vertex px=&quot;0.0&quot; py=&quot;1.0&quot;/&gt;
        &lt;vertex px=&quot;−5.0&quot; py=&quot;1.0&quot;/&gt; 
    &lt;/ polygon&gt;
    &lt;polygon caption=&quot;wall&quot;&gt;
        &lt;vertex px=&quot;0.0&quot; py=&quot;3.0&quot;/&gt; 
        &lt;vertex px=&quot;−5.0&quot; py=&quot;3.0&quot;/&gt;
        &lt;/ polygon&gt;
    &lt;up px=&quot;−5.0&quot; py=&quot;2&quot;/&gt; 
    &lt;down px=&quot;0.0&quot; py=&quot;2&quot;/&gt;
&lt;/subroom&gt;
</code></pre>

<ul>
<li>
<p><code>id</code> mandatory parameter, also referred by crossings and transitions.</p>
</li>
<li>
<p><code>class</code> optional parameter defining the type of the subroom. At the moment two classes are defined:</p>
</li>
<li><code>floor</code></li>
<li><code>stairs</code> takes additionally
    <code>xml
    &lt;up px="-5.0" py="2" /&gt;
    &lt;down px="0.0" py="2" /&gt;</code>
    used in the visualisation, for marking the highest and the lowest point.</li>
<li>
<p>
<script type="math/tex">\_x,\; B\_y,\; C</script> optional parameter for the explicit plane equation of the subroom.
It allows the construction of a 3D environment and should be used to describe stairs. 
The plane equation is given by:  <script type="math/tex">Z = Ax +By + C</script>. 
For instance, if the stair goes through the following points: <script type="math/tex">P1(1,0,0),\; P2 (0,1,0)\; \rm{and}\; P3(0,0,1)</script> 
then the equation is given by: <script type="math/tex">Z= -x -y +1</script>.</p>
</li>
<li>
<p><code>polygon</code> describes the walls as a sequence of vertexes.</p>
</li>
</ul>
<p>To ease navigation, it is recommended to always use convex subrooms. 
In the case the subroom is not convex, additional navigation lines might be required
or the floor field router should be used. </p>
<h3 id="transitions"><a class="toclink" href="#transitions">Transitions</a></h3>
<p>A <code>transition</code> defines the connection between two rooms and is basically a door.
It can be close or open (section &ldquo;traffic constraints&rdquo; in the inifile). </p>
<p>An example transition between two rooms </p>
<pre><code class="xml">&lt;!-- exits between rooms or to outside (room with index = -1) --&gt;
&lt;transition id=&quot;1&quot; caption=&quot;main exit&quot; type=&quot;emergency&quot;
room1_id=&quot;0&quot; subroom1_id=&quot;1&quot; room2_id=&quot;-1&quot; subroom2_id=&quot;-1&quot;&gt;
    &lt;vertex px=&quot;15.0&quot; py=&quot;-5.0&quot;/&gt;
    &lt;vertex px=&quot;17.0&quot; py=&quot;-5.0&quot;/&gt;
&lt;/transition&gt;
</code></pre>

<ul>
<li><code>id</code>, mandatory unique identifier for this <code>transition</code>. 
  The <code>id</code> is also used to close or open the door in the traffic constraints section of the inifile.</li>
<li><code>caption</code>, optional,  used in the visualisation.</li>
<li><code>type</code>, optional. The parameter is not internally used.</li>
<li><code>room1_id</code>, the first room sharing this transition. The order is not important.</li>
<li><code>subroom1_id</code>, the first <code>subroom</code> located in <code>room_1</code>.</li>
<li><code>room2_id</code>, the second room sharing this transition. 
  The order is not important. 
  If there is no second room (meaning this transition is connected to the outside), then use <code>-1</code>.</li>
<li><code>subroom2_id</code>, the second <code>subroom</code> sharing this transition. The order is not important. 
  If there is no second <code>subroom</code> (meaning this transition is connected to the outside), then use <code>-1</code>.</li>
<li><code>vertex</code>: define two ending points of the <code>transition</code>.  </li>
</ul>
<h3 id="crossings"><a class="toclink" href="#crossings">Crossings</a></h3>
<p>A <code>crossing</code> defines the connection between two subrooms inside the same room. 
Unlike <code>transition</code>, they are always open.</p>
<p>A sample <code>crossing</code> between two subrooms</p>
<pre><code class="xml">&lt;!-- virtual exits between subrooms --&gt;
&lt;crossing id=&quot;0&quot; subroom1_id=&quot;0&quot; subroom2_id=&quot;1&quot;&gt;
    &lt;vertex px=&quot;10.0&quot; py=&quot;6.0&quot;/&gt;
    &lt;vertex px=&quot;10.0&quot; py=&quot;4.0&quot;/&gt;
&lt;/crossing&gt;
</code></pre>

<ul>
<li><code>id</code>, mandatory unique identifier for this <code>crossing</code>. </li>
<li><code>subroom1_id</code>, the first <code>subroom</code></li>
<li><code>subroom2_id</code>,  the second <code>subroom</code> sharing this transition. The order is not important. 
  If there is no second subroom (meaning this transition is connected to the outside), 
  then use <code>-1</code>.</li>
<li><code>vertex, define two ending points of the</code>crossing`.</li>
</ul>
<h3 id="obstacles"><a class="toclink" href="#obstacles">Obstacles</a></h3>
<p>One or more obstacles can also be defined within a <code>subroom</code>. </p>
<hr />
<p><strong>Note</strong>: Obstacles should not any intersect with other geometry elements (walls, crossings or transitions).</p>
<hr />
<p>Sample obstacle in a subroom</p>
<pre><code class="xml">&lt;obstacle id=&quot;0&quot; caption=&quot;table&quot; height=&quot;1.0&quot; &gt;
    &lt;polygon&gt;
        &lt;vertex px=&quot;12.0&quot; py=&quot;6.0&quot;/&gt;
        &lt;vertex px=&quot;13.0&quot; py=&quot;6.0&quot;/&gt;
        &lt;vertex px=&quot;13.0&quot; py=&quot;5.5&quot;/&gt;
        &lt;vertex px=&quot;12.0&quot; py=&quot;5.5&quot;/&gt;
        &lt;vertex px=&quot;12.0&quot; py=&quot;6.0&quot;/&gt;
    &lt;/polygon&gt;
&lt;/obstacle&gt;
</code></pre>

<ul>
<li><code>id</code>, mandatory unique identifier for this obstacle.</li>
<li><code>caption</code>, used in the visualisation.</li>
<li><code>height</code>, optional parameter, not used at the moment</li>
<li><code>polygon</code>, describing the obstacle as a sequence of vertex.</li>
</ul>
<h2 id="inifile"><a class="toclink" href="#inifile">Inifile</a></h2>
<p>todo</p>
<h2 id="trajectory"><a class="toclink" href="#trajectory">Trajectory</a></h2>
<p>The results of the simulation are written to files or streamed to a network socket.</p>
<p>Possible formats are:</p>
<ul>
<li><code>xml-plain</code> which is the default xml format</li>
<li><code>plain</code> a flat format (just numbers)</li>
</ul>
<p>Note that if you are using the streaming mode, the format is forced to xml-plain.</p>
<p>The file has three main sections: <code>header</code>, <code>geometry</code> and <code>frames</code>.</p>
<pre><code class="xml">&lt;header version = &quot;0.8&quot;&gt;
    &lt;agents&gt;1&lt;/agents&gt;
    &lt;frameRate&gt;8&lt;/frameRate&gt;
&lt;/header&gt;
</code></pre>

<p>where</p>
<ul>
<li><code>agents</code>: The total number of agents at the beginning of the simulation.</li>
<li>frameRate`: Divide the total number of frames by the framerate to obtain the overall evacuation time.</li>
</ul>
<p>The geometry can be completely embedded within the trajectories or a reference to a file can be supplied.</p>
<pre><code class="xml">&lt;geometry&gt;
    &lt;file location=&quot;corridor_geometry.xml&quot;/&gt;
&lt;/geometry&gt;

</code></pre>

<p>The coordinates of the trajectory are defined in the session <code>frames</code></p>
<pre><code class="xml">&lt;frame ID=&quot;0&quot;&gt;
    &lt;agent ID=&quot;1&quot;   x=&quot;660.00&quot;  y=&quot;333.00&quot;  z=&quot;30.00&quot;   
    rA=&quot;17.94&quot;  rB=&quot;24.94&quot;  eO=&quot;-168.61&quot; eC=&quot;0&quot;/&gt;
&lt;/frame&gt;
&lt;frame ID=&quot;1&quot;&gt;
&lt;agent ID=&quot;1&quot;   x=&quot;658.20&quot;  y=&quot;332.86&quot;  z=&quot;30.00&quot;   
rA=&quot;31.29&quot;  rB=&quot;23.87&quot;  eO=&quot;-175.41&quot; eC=&quot;54&quot;/&gt;
&lt;/frame&gt;
</code></pre>

<ul>
<li><code>ID</code> the id of the pedestrians starting with 1.</li>
<li>
<p><code>x, y, z</code> the position of the agent.</p>
</li>
<li>
<p><code>rA, rB</code>  The shape which is defined by a circle (ellipse) drawn around a human-like figure.<br />
<code>radiusA</code> and <code>radiusB</code> are respectively the semi major axis and the semi minor axis of the ellipse, 
  if the modeled pedestrians&rsquo; shape is an ellipse. 
  Otherwise, if it is a circle those values should be equal to the radius of the circle.</p>
</li>
<li><code>eO, eC</code> are the &ldquo;ellipseOrientation&rdquo; and the &ldquo;ellipseColor&rdquo;. 
  &ldquo;ellipseOrientation&rdquo; is the angle between the  major axis and the X-axis (zero for circle). 
   A color can also be provided, for example for displaying change in velocity. 
   The colours are in the range <code>[0=red, 255=green]</code> and define the proportion between 
   the desired speed (<script type="math/tex">v_0</script>) and the instantaneous velocity.</li>
</ul>
<p>A sample trajectory in the xml format is</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;trajectories&gt;
    &lt;header version = &quot;0.5&quot;&gt;
        &lt;agents&gt;1&lt;/agents&gt;
        &lt;frameRate&gt;8&lt;/frameRate&gt;
    &lt;/header&gt;

    &lt;geometry&gt;
        &lt;file location=&quot;corridor_geometry.xml&quot;/&gt;
    &lt;/geometry&gt;

    &lt;frame ID=&quot;0&quot;&gt;
        &lt;agent ID=&quot;1&quot;   x=&quot;660.00&quot;  y=&quot;333.00&quot;  z=&quot;30.00&quot;   
        rA=&quot;17.94&quot;  rB=&quot;24.94&quot;  eO=&quot;-168.61&quot;    eC=&quot;0&quot;/&gt;
    &lt;/frame&gt;

    &lt;frame ID=&quot;1&quot;&gt;
        &lt;agent ID=&quot;1&quot;   x=&quot;658.20&quot;  y=&quot;332.86&quot;  z=&quot;30.00&quot;   
    rA=&quot;31.29&quot;  rB=&quot;23.87&quot;  eO=&quot;-175.41&quot;    eC=&quot;54&quot;/&gt;
    &lt;/frame&gt;
&lt;/trajectories&gt;
</code></pre>

<p>The other format of the trajectory file is <code>plain-text</code></p>
<p>A sample trajectory in the plain format is as follows:</p>
<pre><code class="xml">                #description: simulation
                #framerate: 16
                #geometry: /home/sim/corridor.xml
                #ID: the agent ID
                #FR: the current frame
                #X,Y,Z: the agents coordinates in metres

                #ID FR  X       Y       Z
                1   0   28.21   131.57  0.00
                2   0   38.41   133.42  0.00
                1   1   28.21   131.57  0.00
                2   1   38.41   133.42  0.00
                1   2   28.24   131.57  0.00
                2   2   38.44   133.42  0.00
                1   3   28.29   131.57  0.00
                2   3   38.49   133.42  0.00
                1   4   28.36   131.57  0.00
                2   4   38.56   133.42  0.00
                1   5   28.44   131.57  0.00
                2   5   38.64   133.42  0.00
                1   6   28.54   131.57  0.00
                2   6   38.74   133.42  0.00
                1   7   28.65   131.57  0.00
                2   7   38.85   133.42  0.00
                1   8   28.77   131.57  0.00
</code></pre></div>
        </div>

	<footer class="col-md-12">
		<hr>
		
		<p>Copyright &copy; 2016 <a href="http://www.fz-juelich.de">Forschungszentrum Jülich GmbH</a>. Maintenance by <a href="http://www.fz-juelich.de/SharedDocs/Personen/IAS/JSC/EN/staff/chraibi_m.html/">Mohcine Chraibi</a>.</p>
		
		<p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
	</footer>


        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
        <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </body>
</html>